% =======================================================================
% Velocities Boundary Condition
% =======================================================================
function [u,v] = Velocities_BC_Perioy(uCBeast, uCBwest,...
    vCBwest, vCBeast, CuCB, CvCB,...
    dx_uE, dx_Wu, dx_Wv, dx_vE, dy_Pn, dy_sP, dx_wP, dx_Pe,...
    Nx,Ny,u,v)

% =======================================================================
% Periodicity -----------------------------------------------------------

% Tangential U Velocity -------------------------------------------------
u(:,1) = u(:,Ny+1);         u(:,Ny+2) = u(:,2);
% -----------------------------------------------------------------------
% Normal V Velocity -----------------------------------------------------
v(2:Nx+1,1) = v(2:Nx+1,Ny) + (dy_sP(2:Nx+1,Ny+1)+dy_Pn(2:Nx+1,Ny+1))...
    ./(dx_Pe(2:Nx+1,Ny+1)+dx_wP(2:Nx+1,Ny+1)).*(u(1:Nx,Ny+1)-u(2:Nx+1,Ny+1));
v(2:Nx+1,Ny+1) = v(2:Nx+1,2) + (dy_sP(2:Nx+1,2)+dy_Pn(2:Nx+1,2))...
    ./(dx_Pe(2:Nx+1,2)+dx_wP(2:Nx+1,2)).*(-u(1:Nx,2)+u(2:Nx+1,2));
% -----------------------------------------------------------------------
% "Smoothing" periodicity -.-.-.-.-.-.-.-.-.-.-.-.-.-.-
v(2:Nx+1,1)=0.5*(v(2:Nx+1,1)+v(2:Nx+1,Ny+1)); v(2:Nx+1,Ny+1)=v(2:Nx+1,1);
% -----------------------------------------------------------------------


% Normal Velocities -----------------------------------------------------
u(1,:)=uCBwest*(1-CuCB(1))  +(u(2,:)-dx_uE(1,:)*uCBwest)*CuCB(1);
u(Nx+1,:)=uCBeast*(1-CuCB(3))  +(u(Nx,:)+dx_Wu(Nx+1,:)*uCBeast)*CuCB(3);
% ------------------------------------------------------------------------
% Tangential Velocities --------------------------------------------------
v(1,:)=(2*vCBwest-v(2,:))*(1-CvCB(1))+(v(2,:)-dx_vE(1,:)*vCBwest)*CvCB(1);
v(Nx+2,:)=(2*vCBeast-v(Nx+1,:))*(1-CvCB(3))+(v(Nx+1,:)+dx_Wv(Nx+2,:)*vCBeast)*CvCB(3);
% =======================================================================
