% =======================================================================
% Velocities Boundary Condition
% Periodicity in lateral Boundaries
% =======================================================================
function [u,v] = Velocities_BC(uCBeast, uCBwest, vCBsouth, vCBnorth,...
    uCBsouth, uCBnorth, vCBwest, vCBeast, CuCB, CvCB,...
    dx_uE, dx_Wu, dy_vN, dy_Sv, dy_uN, dx_Wv, dy_Su, dx_vE, ...
    Nx,Ny,u,v)

% =======================================================================
% Periodicity -----------------------------------------------------------

% Tangential V Velocity -------------------------------------------------
v(1,:)=v(Nx+1,:); v(Nx+2,:)=v(2,:);
% -----------------------------------------------------------------------
% Normal U Velocity -----------------------------------------------------
u(1,2:Ny+1)=u(Nx,2:Ny+1)+(dx_Pe(Nx+1,2:Ny+1)+dx_wP(Nx+1,2:Ny+1))...
    ./(dy_sP(Nx,2:Ny+1)+dy_Pn(Nx,2:Ny+1)).*(v(Nx+1,1:Ny)-v(Nx+1,2:Ny+1));
u(Nx+1,2:Ny+1)=u(2,2:Ny+1)+(dx_Pe(2,2:Ny+1)+dx_wP(2,2:Ny+1))...
    ./(dy_sP(2,2:Ny+1)+dy_Pn(2,2:Ny+1)).*(v(2,2:Ny+1)-v(2,1:Ny));
% -----------------------------------------------------------------------
% "Smoothing" periodicity -.-.-.-.-.-.-.-.-.-.-.-.-.-.-
u(1,2:Ny+1)=0.5*(u(1,2:Ny+1)+u(Nx+1,2:Ny+1)); u(Nx+1,2:Ny+1)=u(1,2:Ny+1);
% -----------------------------------------------------------------------

% Normal v Velocity -----------------------------------------------------
v(:,1)=vCBsouth.*(1-CvCB(4))  +(v(:,2)-dy_vN(:,1).*vCBsouth).*CvCB(4);
v(:,Ny+1)=vCBnorth.*(1-CvCB(2))  +(v(:,Ny)+dy_Sv(:,Ny+1).*vCBnorth).*CvCB(2);
% Tangential u Velocity -------------------------------------------------
u(:,1)=(2*uCBsouth-u(:,2)).*(1-CuCB(4))+...
    (u(:,2)-dy_uN(:,2).*uCBsouth).*CuCB(4);
u(:,Ny+2)=(2*uCBnorth-u(:,Ny+1)).*(1-CuCB(2))+...
    (u(:,Ny+1)+dy_Su(:,Ny+2).*uCBnorth).*CuCB(2);
% -----------------------------------------------------------------------

% =======================================================================
